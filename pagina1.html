<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Digital Move</title>

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <link rel="stylesheet" href="estilos.css">
</head>

<body>

  <!-- HEADER -->
  <header class="app-header">
    <img src="imagenes/logo_header.png" class="logo">
    <div class="icons">
      <i class="fa-regular fa-bell" onclick="abrirNotificaciones()"></i>
      <i class="fa-solid fa-circle-info" onclick="abrirAvisos()"></i>
      <i class="fa-regular fa-comment-dots" onclick="abrirChat()"></i>
    </div>
  </header>

  <!-- PANEL DE NOTIFICACIONES -->
  <div class="notif-overlay" id="notif-overlay" onclick="cerrarNotificaciones()"></div>
  <div class="notif-panel" id="notif-panel">
    <div class="notif-header">
      <h3><i class="fa-regular fa-bell"></i> Notificaciones</h3>
      <button onclick="cerrarNotificaciones()">
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="notif-vacio">
      <i class="fa-regular fa-bell" style="font-size:3rem; color:#90A4AE;"></i>
      <p>No tienes notificaciones nuevas</p>
    </div>
  </div>

  <!-- PANEL DE AVISOS -->
  <div class="notif-overlay" id="avisos-overlay" onclick="cerrarAvisos()"></div>
  <div class="notif-panel" id="avisos-panel">
    <div class="notif-header">
      <h3><i class="fa-solid fa-circle-info"></i> Avisos</h3>
      <button onclick="cerrarAvisos()">
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="notif-vacio">
      <i class="fa-solid fa-circle-info" style="font-size:3rem; color:#90A4AE;"></i>
      <p>No hay avisos por el momento</p>
    </div>
  </div>

  <!-- CHATBOT -->
  <div class="notif-overlay" id="chat-overlay" onclick="cerrarChat()"></div>
  <div class="chat-panel" id="chat-panel">
    <div class="notif-header">
      <h3><i class="fa-regular fa-comment-dots"></i> Asistente Digital Move</h3>
      <button onclick="cerrarChat()">
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="chat-messages" id="chat-messages">
      <div class="chat-burbuja bot">
        <div class="bot-avatar"><i class="fa-regular fa-comment-dots"></i></div>
        <div class="burbuja-texto">
          ¡Hola! Soy el asistente de <strong>Digital Move</strong>.
          ¿En qué puedo ayudarte?
        </div>
      </div>
    </div>
    <div class="chat-opciones" id="chat-opciones">
      <button class="chat-btn" onclick="responder('horario')">
        <i class="fa-regular fa-clock"></i> Horario de servicio
      </button>
      <button class="chat-btn" onclick="responder('caracteristicas')">
        <i class="fa-solid fa-star"></i> Características de las unidades
      </button>
      <button class="chat-btn" onclick="responder('ruta')">
        <i class="fa-solid fa-route"></i> Ruta del servicio
      </button>
      <button class="chat-btn" onclick="responder('capacidad')">
        <i class="fa-solid fa-users"></i> Capacidad de las unidades
      </button>
      <button class="chat-btn" onclick="responder('contacto')">
        <i class="fa-solid fa-envelope"></i> Contacto
      </button>
    </div>
  </div>

  <!-- MAPA -->
  <main class="map-container">
    <div id="map"></div>
  </main>

  <!-- PANEL INFERIOR -->
  <section class="bottom-sheet">

    <!-- ICONOS MAPA -->
    <nav class="nav-bar">
      <div class="nav-item">
        <div class="nav-icon red">
          <i class="fa-solid fa-location-dot"></i>
        </div>
        <span>Inicio</span>
      </div>
      <div class="nav-item">
        <div class="nav-icon green">
          <i class="fa-solid fa-location-dot"></i>
        </div>
        <span>Destino</span>
      </div>
      <div class="nav-item">
        <div class="nav-icon blue">
          <i class="fa-solid fa-map-pin"></i>
        </div>
        <span>Paradas</span>
      </div>
      <div class="nav-item">
        <div class="nav-icon gray">
          <i class="fa-solid fa-bus"></i>
        </div>
        <span>Unidades</span>
      </div>
      <div class="nav-item">
        <div class="nav-icon dark">
          <i class="fa-solid fa-car-burst"></i>
        </div>
        <span>Accidentes</span>
      </div>
    </nav>

    <h3>Rutas Disponibles</h3>

    <!-- CARDS DE UNIDADES -->
    <div class="card">
      <div class="card-top">
        <img src="imagenes/microbusito.png" class="card-bus-img">
        <span class="card-nombre">Unidad 1</span>
      </div>
      <div class="progress">
        <div style="width:50%"></div>
      </div>
      <p class="card-capacidad">28 / 50</p>
      <div class="card-info">
        <p class="card-parada-tiempo">
          <i class="fa-regular fa-clock" style="color:#E53935;"></i>
          Próxima parada: 15 min.
        </p>
        <p class="card-parada-nombre">
          <i class="fa-solid fa-location-dot" style="color:#1565C0;"></i>
          Parada: Casino Vivento
        </p>
      </div>
    </div>

    <div class="card">
      <div class="card-top">
        <img src="imagenes/microbusito_negro.png" class="card-bus-img">
        <span class="card-nombre">Unidad 2</span>
      </div>
      <div class="progress">
        <div style="width:70%"></div>
      </div>
      <p class="card-capacidad">35 / 50</p>
      <div class="card-info">
        <p class="card-parada-tiempo">
          <i class="fa-regular fa-clock" style="color:#E53935;"></i>
          Próxima parada: 10 min.
        </p>
        <p class="card-parada-nombre">
          <i class="fa-solid fa-location-dot" style="color:#1565C0;"></i>
          Parada: Parque Silva
        </p>
      </div>
    </div>

    <div class="card">
      <div class="card-top">
        <img src="imagenes/microbusito.png" class="card-bus-img">
        <span class="card-nombre">Unidad 3</span>
      </div>
      <div class="progress">
        <div style="width:30%"></div>
      </div>
      <p class="card-capacidad">15 / 50</p>
      <div class="card-info">
        <p class="card-parada-tiempo">
          <i class="fa-regular fa-clock" style="color:#E53935;"></i>
          Próxima parada: 15 min.
        </p>
        <p class="card-parada-nombre">
          <i class="fa-solid fa-location-dot" style="color:#1565C0;"></i>
          Parada: Centro comercial
        </p>
      </div>
    </div>

    <!-- HORARIO DE SERVICIO -->
    <div class="schedule">
      <h3>Horario de servicio</h3>
      <div class="schedule-box">
        <div class="schedule-col">
          <strong>Matutino</strong>
          <div class="horario-item">
            <span class="circulo"></span> 5:30 a.m
          </div>
          <div class="horario-item">
            <span class="circulo"></span> 7:00 a.m
          </div>
        </div>
        <div class="divider"></div>
        <div class="schedule-col">
          <strong>Vespertino</strong>
          <div class="horario-item">
            <span class="circulo"></span> 1:00 p.m
          </div>
          <div class="horario-item">
            <span class="circulo"></span> 2:00 p.m
          </div>
        </div>
      </div>
    </div>

    <!-- CARACTERÍSTICAS -->
    <div class="features">
      <h3>Características</h3>
      <div class="features-grid">
        <div class="feature-item">
          <i class="fa-solid fa-snowflake"></i>
          <span>Aire acondicionado</span>
        </div>
        <div class="feature-item">
          <i class="fa-solid fa-wifi"></i>
          <span>Wi-Fi gratuito</span>
        </div>
        <div class="feature-item">
          <i class="fa-solid fa-satellite-dish"></i>
          <span>GPS en tiempo real</span>
        </div>
        <div class="feature-item">
          <i class="fa-solid fa-tag"></i>
          <span>Costo gratuito</span>
        </div>
        <div class="feature-item">
          <i class="fa-solid fa-circle-check"></i>
          <span>Choferes verificados</span>
        </div>
      </div>
    </div>

    <!-- FOOTER -->
    <footer class="app-footer">
      <div class="footer-top">
        <img src="imagenes/logo_inicial.png" alt="Digital Move" class="footer-logo">
      </div>
      <div class="footer-links">
        <a href="#">Políticas de privacidad</a>
        <a href="#">Términos y Condiciones</a>
      </div>
      <div class="footer-divider"></div>
      <div class="footer-contacto">
        <p class="footer-titulo-seccion">Contáctanos</p>
        <p>digitalmove_oficial@gmail.com</p>
      </div>
      <div class="footer-redes">
        <p class="footer-titulo-seccion">Síguenos en</p>
        <div class="footer-icons">
          <a href="https://www.facebook.com/share/18KEG4t5gC/" target="_blank" title="Facebook">
            <i class="fa-brands fa-facebook"></i>
          </a>
          <a href="https://www.instagram.com/digitalmove_st" target="_blank" title="Instagram">
            <i class="fa-brands fa-instagram"></i>
          </a>
          <a href="#" target="_blank" title="WhatsApp">
            <i class="fa-brands fa-whatsapp"></i>
          </a>
        </div>
      </div>
      <div class="footer-divider"></div>
      <div class="footer-copyright">
        <p><i class="fa-regular fa-copyright"></i> 2025 Digital Move. Todos los derechos reservados.</p>
      </div>
    </footer>

  </section>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

  <!-- ✅ CHATBOT — debe ir ANTES del script del mapa -->
  <script src="chatbot.js"></script>

  <script>
    // 1. LEER COORDENADAS
    const gpsActivo = sessionStorage.getItem('gps') === 'true';
    const userLat   = parseFloat(sessionStorage.getItem('lat'));
    const userLng   = parseFloat(sessionStorage.getItem('lng'));

    // 2. INICIALIZAR MAPA
    const centroInicial = (gpsActivo && !isNaN(userLat))
      ? [userLat, userLng]
      : [25.78848, -100.16110];

    const map = L.map('map').setView(centroInicial, 14);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '© OpenStreetMap'
    }).addTo(map);

    // 3. MARCADOR DEL USUARIO
    if (gpsActivo && !isNaN(userLat)) {
      const iconoUsuario = L.divIcon({
        html: `<div style="
          width:18px; height:18px;
          background:#1565C0;
          border:3px solid white;
          border-radius:50%;
          box-shadow:0 0 0 5px rgba(21,101,192,0.25);
        "></div>`,
        iconSize: [18, 18], iconAnchor: [9, 9], className: ''
      });
      L.marker([userLat, userLng], { icon: iconoUsuario })
        .addTo(map)
        .bindPopup('Tu ubicación actual')
        .openPopup();
    }

// 4. MARCADORES DE PARADAS
const iOrigen  = L.divIcon({ html:`<div class="marcador-origen"></div>`,  iconSize:[14,14], iconAnchor:[7,7],  className:'' });
const iDestino = L.divIcon({ html:`<div class="marcador-destino"></div>`, iconSize:[14,14], iconAnchor:[7,7],  className:'' });
const iParada  = L.divIcon({ html:`<div class="marcador-parada"></div>`,  iconSize:[10,10], iconAnchor:[5,5],  className:'' });

L.marker([25.782070, -100.188452], { icon: iOrigen  }).addTo(map).bindPopup('Origen: Centro de Apodaca');
L.marker([25.80045,  -100.13580 ], { icon: iDestino }).addTo(map).bindPopup('Destino: Universidad Politécnica');

// Agrega tus paradas aquí
L.marker([25.776715, -100.184839], { icon: iParada }).addTo(map).bindPopup('Parada 1');
L.marker([25.789168, -100.144996], { icon: iParada }).addTo(map).bindPopup('Parada 2');
L.marker([25.789362, -100.145242], { icon: iParada }).addTo(map).bindPopup('Parada 3');
L.marker([25.784976, -100.159624], { icon: iParada }).addTo(map).bindPopup('Parada 4');
L.marker([25.779093, -100.179286], { icon: iParada }).addTo(map).bindPopup('Parada 5');
L.marker([25.777747, -100.183938], { icon: iParada }).addTo(map).bindPopup('Parada 6');

    // 5. ÍCONO DEL BUS
    const busIcon = L.icon({
      iconUrl: 'imagenes/bus.png',
      iconSize: [40, 40],
      iconAnchor: [20, 20]
    });

    // 6. RUTA DEL BUS
    const rutaBus = [
      [25.78197,-100.18837],[25.78148,-100.18808],[25.78121,-100.18791],
      [25.78071,-100.1876],[25.77993,-100.18711],[25.77962,-100.18692],
      [25.77939,-100.18677],[25.77915,-100.18662],[25.77838,-100.18614],
      [25.778,-100.1859],[25.77786,-100.18581],[25.77773,-100.18573],
      [25.77761,-100.18565],[25.77715,-100.18539],[25.77707,-100.18534],
      [25.77702,-100.18546],[25.77694,-100.18565],[25.77685,-100.18571],
      [25.77679,-100.18578],[25.77673,-100.18586],[25.77669,-100.18589],
      [25.77665,-100.18591],[25.77662,-100.18592],[25.77659,-100.18593],
      [25.77655,-100.18593],[25.7765,-100.18591],[25.77646,-100.1859],
      [25.77638,-100.18586],[25.77634,-100.18582],[25.7763,-100.18578],
      [25.77628,-100.18575],[25.77626,-100.18571],[25.77626,-100.18568],
      [25.77627,-100.18564],[25.7763,-100.18551],[25.77633,-100.18548],
      [25.77639,-100.18542],[25.77655,-100.18527],[25.77658,-100.18524],
      [25.77662,-100.18519],[25.77665,-100.18515],[25.77674,-100.18502],
      [25.77687,-100.18479],[25.77696,-100.18462],[25.77702,-100.18449],
      [25.77712,-100.18424],[25.77718,-100.1841],[25.77722,-100.18403],
      [25.77725,-100.18399],[25.77728,-100.18394],[25.77734,-100.18389],
      [25.77737,-100.18376],[25.77742,-100.1836],[25.77759,-100.18294],
      [25.77766,-100.18265],[25.77782,-100.18201],[25.77825,-100.1806],
      [25.7784,-100.18012],[25.77854,-100.17971],[25.77889,-100.17868],
      [25.77899,-100.17839],[25.77971,-100.17623],[25.78093,-100.17225],
      [25.78111,-100.17163],[25.7812,-100.17129],[25.78174,-100.16952],
      [25.78187,-100.1691],[25.78195,-100.16883],[25.78218,-100.16804],
      [25.78269,-100.1663],[25.78324,-100.16449],[25.78373,-100.16294],
      [25.78385,-100.16254],[25.78401,-100.16198],[25.78406,-100.16185],
      [25.78414,-100.16157],[25.78431,-100.16098],[25.78469,-100.15976],
      [25.78513,-100.1583],[25.7853,-100.15776],[25.78546,-100.15723],
      [25.78576,-100.15627],[25.7859,-100.15585],[25.78629,-100.15462],
      [25.78668,-100.15336],[25.78703,-100.15226],[25.78754,-100.15054],
      [25.78786,-100.14948],[25.78805,-100.14884],[25.78828,-100.14811],
      [25.78837,-100.14782],[25.78857,-100.14716],[25.78919,-100.14514],
      [25.78922,-100.14504],[25.78935,-100.14459],[25.78982,-100.14296],
      [25.78986,-100.14283],[25.7903,-100.14136],[25.79078,-100.13988],
      [25.79081,-100.1398],[25.79122,-100.13845],[25.79251,-100.13415],
      [25.79254,-100.1339],[25.79256,-100.13377],[25.7926,-100.13358],
      [25.79285,-100.13272],[25.79303,-100.13214],[25.79358,-100.13035],
      [25.79363,-100.13029],[25.79365,-100.13027],[25.79368,-100.13025],
      [25.79372,-100.13025],[25.79376,-100.13026],[25.7938,-100.13029],
      [25.79382,-100.13032],[25.79382,-100.13036],[25.79384,-100.13047],
      [25.7933,-100.13216],[25.79321,-100.13244],[25.79309,-100.13282],
      [25.79301,-100.13306],[25.79292,-100.13334],[25.79283,-100.13365],
      [25.79276,-100.13386],[25.7927,-100.13401],[25.79259,-100.13417],
      [25.79236,-100.13496],[25.79196,-100.13625],[25.79203,-100.13627],
      [25.79224,-100.13633],[25.79283,-100.13647],[25.7992,-100.138],
      [25.79927,-100.138],[25.79931,-100.138],[25.79934,-100.13797],
      [25.79993,-100.13651],[25.80015,-100.13599],[25.80018,-100.13588],
      [25.80019,-100.13581],[25.80019,-100.13526],[25.80019,-100.13506]
    ];

    const rutaBus2 = [
      [25.78197,-100.18837],[25.78148,-100.18808],[25.78121,-100.18791],
      [25.78071,-100.1876],[25.77993,-100.18711],[25.77962,-100.18692],
      [25.77939,-100.18677],[25.77915,-100.18662],[25.77838,-100.18614],
      [25.778,-100.1859],[25.77786,-100.18581],[25.77773,-100.18573],
      [25.77761,-100.18565],[25.77715,-100.18539],[25.77707,-100.18534],
      [25.77702,-100.18546],[25.77694,-100.18565],[25.77685,-100.18571],
      [25.77679,-100.18578],[25.77673,-100.18586],[25.77669,-100.18589],
      [25.77665,-100.18591],[25.77662,-100.18592],[25.77659,-100.18593],
      [25.77655,-100.18593],[25.7765,-100.18591],[25.77646,-100.1859],
      [25.77638,-100.18586],[25.77634,-100.18582],[25.7763,-100.18578],
      [25.77628,-100.18575],[25.77626,-100.18571],[25.77626,-100.18568],
      [25.77627,-100.18564],[25.7763,-100.18551],[25.77633,-100.18548],
      [25.77639,-100.18542],[25.77655,-100.18527],[25.77658,-100.18524],
      [25.77662,-100.18519],[25.77665,-100.18515],[25.77674,-100.18502],
      [25.77687,-100.18479],[25.77696,-100.18462],[25.77702,-100.18449],
      [25.77712,-100.18424],[25.77718,-100.1841],[25.77722,-100.18403],
      [25.77725,-100.18399],[25.77728,-100.18394],[25.77734,-100.18389],
      [25.77737,-100.18376],[25.77742,-100.1836],[25.77759,-100.18294],
      [25.77766,-100.18265],[25.77782,-100.18201],[25.77825,-100.1806],
      [25.7784,-100.18012],[25.77854,-100.17971],[25.77889,-100.17868],
      [25.77899,-100.17839],[25.77971,-100.17623],[25.78093,-100.17225],
      [25.78111,-100.17163],[25.7812,-100.17129],[25.78174,-100.16952],
      [25.78187,-100.1691],[25.78195,-100.16883],[25.78218,-100.16804],
      [25.78269,-100.1663],[25.78324,-100.16449],[25.78373,-100.16294],
      [25.78385,-100.16254],[25.78401,-100.16198],[25.78406,-100.16185],
      [25.78414,-100.16157],[25.78431,-100.16098],[25.78469,-100.15976],
      [25.78513,-100.1583],[25.7853,-100.15776],[25.78546,-100.15723],
      [25.78576,-100.15627],[25.7859,-100.15585],[25.78629,-100.15462],
      [25.78668,-100.15336],[25.78703,-100.15226],[25.78754,-100.15054],
      [25.78786,-100.14948],[25.78805,-100.14884],[25.78828,-100.14811],
      [25.78837,-100.14782],[25.78857,-100.14716],[25.78919,-100.14514],
      [25.78922,-100.14504],[25.78935,-100.14459],[25.78982,-100.14296],
      [25.78986,-100.14283],[25.7903,-100.14136],[25.79078,-100.13988],
      [25.79081,-100.1398],[25.79122,-100.13845],[25.79251,-100.13415],
      [25.79254,-100.1339],[25.79256,-100.13377],[25.7926,-100.13358],
      [25.79285,-100.13272],[25.79303,-100.13214],[25.79358,-100.13035],
      [25.79363,-100.13029],[25.79365,-100.13027],[25.79368,-100.13025],
      [25.79372,-100.13025],[25.79376,-100.13026],[25.7938,-100.13029],
      [25.79382,-100.13032],[25.79382,-100.13036],[25.79384,-100.13047],
      [25.7933,-100.13216],[25.79321,-100.13244],[25.79309,-100.13282],
      [25.79301,-100.13306],[25.79292,-100.13334],[25.79283,-100.13365],
      [25.79276,-100.13386],[25.7927,-100.13401],[25.79259,-100.13417],
      [25.79236,-100.13496],[25.79196,-100.13625],[25.79203,-100.13627],
      [25.79224,-100.13633],[25.79283,-100.13647],[25.7992,-100.138],
      [25.79927,-100.138],[25.79931,-100.138],[25.79934,-100.13797],
      [25.79993,-100.13651],[25.80015,-100.13599],[25.80018,-100.13588],
      [25.80019,-100.13581],[25.80019,-100.13526],[25.80019,-100.13506]
    ];

    const rutaBus3 = [
      [25.78197,-100.18837],[25.78148,-100.18808],[25.78121,-100.18791],
      [25.78071,-100.1876],[25.77993,-100.18711],[25.77962,-100.18692],
      [25.77939,-100.18677],[25.77915,-100.18662],[25.77838,-100.18614],
      [25.778,-100.1859],[25.77786,-100.18581],[25.77773,-100.18573],
      [25.77761,-100.18565],[25.77715,-100.18539],[25.77707,-100.18534],
      [25.77702,-100.18546],[25.77694,-100.18565],[25.77685,-100.18571],
      [25.77679,-100.18578],[25.77673,-100.18586],[25.77669,-100.18589],
      [25.77665,-100.18591],[25.77662,-100.18592],[25.77659,-100.18593],
      [25.77655,-100.18593],[25.7765,-100.18591],[25.77646,-100.1859],
      [25.77638,-100.18586],[25.77634,-100.18582],[25.7763,-100.18578],
      [25.77628,-100.18575],[25.77626,-100.18571],[25.77626,-100.18568],
      [25.77627,-100.18564],[25.7763,-100.18551],[25.77633,-100.18548],
      [25.77639,-100.18542],[25.77655,-100.18527],[25.77658,-100.18524],
      [25.77662,-100.18519],[25.77665,-100.18515],[25.77674,-100.18502],
      [25.77687,-100.18479],[25.77696,-100.18462],[25.77702,-100.18449],
      [25.77712,-100.18424],[25.77718,-100.1841],[25.77722,-100.18403],
      [25.77725,-100.18399],[25.77728,-100.18394],[25.77734,-100.18389],
      [25.77737,-100.18376],[25.77742,-100.1836],[25.77759,-100.18294],
      [25.77766,-100.18265],[25.77782,-100.18201],[25.77825,-100.1806],
      [25.7784,-100.18012],[25.77854,-100.17971],[25.77889,-100.17868],
      [25.77899,-100.17839],[25.77971,-100.17623],[25.78093,-100.17225],
      [25.78111,-100.17163],[25.7812,-100.17129],[25.78174,-100.16952],
      [25.78187,-100.1691],[25.78195,-100.16883],[25.78218,-100.16804],
      [25.78269,-100.1663],[25.78324,-100.16449],[25.78373,-100.16294],
      [25.78385,-100.16254],[25.78401,-100.16198],[25.78406,-100.16185],
      [25.78414,-100.16157],[25.78431,-100.16098],[25.78469,-100.15976],
      [25.78513,-100.1583],[25.7853,-100.15776],[25.78546,-100.15723],
      [25.78576,-100.15627],[25.7859,-100.15585],[25.78629,-100.15462],
      [25.78668,-100.15336],[25.78703,-100.15226],[25.78754,-100.15054],
      [25.78786,-100.14948],[25.78805,-100.14884],[25.78828,-100.14811],
      [25.78837,-100.14782],[25.78857,-100.14716],[25.78919,-100.14514],
      [25.78922,-100.14504],[25.78935,-100.14459],[25.78982,-100.14296],
      [25.78986,-100.14283],[25.7903,-100.14136],[25.79078,-100.13988],
      [25.79081,-100.1398],[25.79122,-100.13845],[25.79251,-100.13415],
      [25.79254,-100.1339],[25.79256,-100.13377],[25.7926,-100.13358],
      [25.79285,-100.13272],[25.79303,-100.13214],[25.79358,-100.13035],
      [25.79363,-100.13029],[25.79365,-100.13027],[25.79368,-100.13025],
      [25.79372,-100.13025],[25.79376,-100.13026],[25.7938,-100.13029],
      [25.79382,-100.13032],[25.79382,-100.13036],[25.79384,-100.13047],
      [25.7933,-100.13216],[25.79321,-100.13244],[25.79309,-100.13282],
      [25.79301,-100.13306],[25.79292,-100.13334],[25.79283,-100.13365],
      [25.79276,-100.13386],[25.7927,-100.13401],[25.79259,-100.13417],
      [25.79236,-100.13496],[25.79196,-100.13625],[25.79203,-100.13627],
      [25.79224,-100.13633],[25.79283,-100.13647],[25.7992,-100.138],
      [25.79927,-100.138],[25.79931,-100.138],[25.79934,-100.13797],
      [25.79993,-100.13651],[25.80015,-100.13599],[25.80018,-100.13588],
      [25.80019,-100.13581],[25.80019,-100.13526],[25.80019,-100.13506]
    ];
    L.polyline(rutaBus, { color:'#1565C0', weight:4, opacity:0.75 }).addTo(map);
     L.polyline(rutaBus2, { color:'#1565C0', weight:4, opacity:0.75 }).addTo(map);
      L.polyline(rutaBus3, { color:'#1565C0', weight:4, opacity:0.75 }).addTo(map);

    // 7. ANIMACIÓN DEL BUS
    let busMarker  = L.marker(rutaBus[0],                              { icon: busIcon }).addTo(map);
    let busMarker2 = L.marker(rutaBus2[Math.floor(rutaBus.length / 3)],  { icon: busIcon }).addTo(map);
    let busMarker3 = L.marker(rutaBus3[Math.floor(rutaBus.length / 3) * 2], { icon: busIcon }).addTo(map);

    let paso  = 0;
    let paso2 = Math.floor(rutaBus.length / 3);
    let paso3 = Math.floor(rutaBus.length / 3) * 2;

    setInterval(() => {
      paso++;
      if (paso >= rutaBus.length) paso = 0;
      busMarker.setLatLng(rutaBus[paso]);
    }, 1500);

    setInterval(() => {
      paso2++;
      if (paso2 >= rutaBus2.length) paso2 = 0;
      busMarker2.setLatLng(rutaBus2[paso2]);
    }, 1500);

    setInterval(() => {
      paso3++;
      if (paso3 >= rutaBus3.length) paso3 = 0;
      busMarker3.setLatLng(rutaBus3[paso3]);
    }, 1500);;

    // 8. NOTIFICACIONES
    function abrirNotificaciones() {
      document.getElementById('notif-panel').classList.add('activo');
      document.getElementById('notif-overlay').classList.add('activo');
    }

    function cerrarNotificaciones() {
      document.getElementById('notif-panel').classList.remove('activo');
      document.getElementById('notif-overlay').classList.remove('activo');
    }

    function abrirAvisos() {
      document.getElementById('avisos-panel').classList.add('activo');
      document.getElementById('avisos-overlay').classList.add('activo');
    }

    function cerrarAvisos() {
      document.getElementById('avisos-panel').classList.remove('activo');
      document.getElementById('avisos-overlay').classList.remove('activo');
    }
  </script>

</body>
</html>


